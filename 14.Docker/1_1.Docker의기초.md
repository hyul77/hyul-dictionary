# 1_1.Docker의 기초
## Docker
### Docker란?
- Linux Container에 여러 기능을 추가해 애플리케이션을 Container로서 좀더 쉽게 사용할 수 있게 만들어진 오픈소스 프로젝트
- Docker는 Go 언어로 작성되어 꾸준히 개발됨
- 가상머신하고는 다르게 성능의 손실이 거의 없어 클라우드 인프라 솔루션으로 주목

### 가상머신
- 하이퍼바이저를 이용해 여러개의 운영체제를 하나의 호스트에 생성해 사용
- 여러개의 운영체제는 가상머신이라는 단위로 구별, 우분투, CentOS등의 운영체제 설치
- 하이퍼바이저에 의해 생성되고 관리되는 운영체제를 게스트 운영체제라하고 다른 게스트 운영체제와는 완전히 독립된 공간과 시스템 자원을 할당받아 사용
- 자원을 가상화해 독립된 공간을 생성하는 작업은 하이퍼바이저가 반드시 거치기 떄문에 성능 손실이 발생
- 가상머신 배포하기 위해 이미지로 만들었을 때 이미지의 크기가 크다는 단점

### 하이퍼바이저
- 단일 물리적 머신에서 여러 가상 머신을 실행하는데 사용할 수 있는 SW
- 고유한 운영체제와 애플리케이션이 있음
- 필요에 따라 CPU 및 메모리와 같은 물리적 컴퓨팅 리소스를 개별 가상머신에 할당
- 물리적 IT 인프라의 최적 사용을 지원

### Docker Container
- 가상화된 공간을 생성하기 위해 리눅스의 자체 기능인 chroot, namespace, cgroup을 사용
- 위 기능들을 통해 프로세스 단위의 격리 환경을 만들어 성능 손실이 거의 없음
- Container에 필요한 커널은 호스트의 커널을 공유해 사용
- Container에 애플리케이션을 구동하는데 필요한 라이브러리 및 실행 파일만 존재
- 이미지로 만들 때 가상 머신에 비해 매우 작음

### Docker의 장점
- 개발과 배포가 편해짐
- 내부에서 여러 작업을 마친 뒤 운영 환경에 배포하려면 이미지(패키지)로 만들어 운영 서버에 전달하기만 하면 됨
- 여러 애플리케이션의 독립성 및 확정성이 커짐
- 여러 모듈이 상호작용하는 로직을 하나의 프로그램 내에서 구동시키는 방식인 모놀리스 애플리케이션은 소규모 서비스에는 적합하지만 확장성과 유연성은 없음
- 모놀리스를 대체하는 마이크로서비스구조에서 가장 많이 사용됨

## Docker 엔진
- 기본단위 : 이미지와 컨테이너

### 도커 이미지
- 컨테이너를 생성할 때 필요한 요소, 가상머신에서 iso파일과 비슷한 개념
- 이미지는 여러 개의 계층으로 된 바이너리 파일로 존재
- 컨테이너를 생성하고 실행할 때 읽기 전용으로 사용
- 이미지는 도커 명령어로 내려 받을 수 있으므로 별도 설치할 필요 없음

### 사용법
- [저장소 이름]/[이미지이름]:[태그(이미지버전)]
- 저장소 이름은 이미지가 저장된 장소를 의미
- 명시안되는 경우는 도커 허브의 공식 이미지임
- 이미지 이름은 보통 어떤 역할을 하는지 나타냄
- 태그는 이미지의 버전관리 또는 Revision 관리에 사용
- 태그 생략시 최근으로 인식

### 도커 컨테이너
- 아파치 웹, nginx, mysql, hadoop, spark 등의 도커 이미지 존재
- 이미지를 통해 컨테이너를 생성하면 목적에 맞는 파일이 들어 있는 파일 시스템과 격리된 시스템 자원 및 네트워크를 사용할 수 있는 독립 공간 생성
- 이미지를 읽기 전용으로 사용해 컨테이너에서 무엇을 하든 원래 이미지에 영향 없음
- 생성된 각 컨테이너는 독립된 파일 시스템을 제공받아 호스트와 분리돼 특정 컨테이너에서 어떤 애플리케이션을 설치하거나 삭제해도 다른 컨테이너와 호스트에 변화 없음

### 도커 컨테이너 활용
- 웹 서버 도커 이미지로부터 여러개의 컨테이너를 생성하면 생성된 컨테이너의 개수만큼 웹 서비스가 생성, 외부에 웹 서비스를 제공하는데 사용

### 이미지의 레이어 구조
- 이미지는 애플리케이션과 각종 파일을 담고 있어 압축파일과 비슷함
- 이미지는 같은 내용일 경우 여러 이미지에 동일한 레이어를 공유해 전체 용량 감소
- 내용이 같은 레이어1, 레이어2를 공유하기 때문에 전체 공간을 봤을 때 상대적으로 용량이 작음